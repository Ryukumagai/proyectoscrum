<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>My Homework</title>
  <style>
    :root {
      --azul-oscuro: #0a2342;
      --azul-medio: #185adb;
      --azul-claro: #f3f8ff;
      --blanco: #fff;
      --sombra: 0 4px 16px rgba(24,90,219,0.12);
      --gris: #e5e9f2;
      --verde: #3ec300;
      --rojo: #e74c3c;
    }
    body {
      min-height: 100vh;
      margin: 0;
      background: linear-gradient(135deg, var(--azul-claro) 0%, var(--azul-medio) 100%);
      font-family: 'Segoe UI', 'Arial', sans-serif;
      color: var(--azul-oscuro);
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .container {
      background: var(--blanco);
      border-radius: 24px;
      box-shadow: 0 8px 32px rgba(10,35,66,0.18);
      padding: 2.5rem 2rem 2rem 2rem;
      max-width: 500px;
      width: 100%;
      display: flex;
      flex-direction: column;
      align-items: center;
      transition: box-shadow 0.2s;
    }
    h1 {
      margin-top: 0;
      font-size: 2.2rem;
      color: var(--azul-medio);
      font-weight: 700;
      letter-spacing: 1px;
    }
    .welcome {
      font-size: 1.1rem;
      margin-bottom: 2rem;
      color: var(--azul-oscuro);
      text-align: center;
    }
    input[type="text"], input[type="date"] {
      width: 100%;
      display: block;
      box-sizing: border-box;
      padding: 0.8rem 1rem;
      border: 1.5px solid var(--azul-medio);
      border-radius: 10px;
      font-size: 1rem;
      margin-bottom: 1.2rem;
      outline: none;
      background: var(--azul-claro);
      color: var(--azul-oscuro);
      transition: border 0.2s;
    }
    #userName {
      display: block;
      width: 100%;
      box-sizing: border-box;
    }
    #startBtn {
      width: 100%;
      padding: 0.9rem 0;
      background: var(--azul-medio);
      color: var(--blanco);
      border: none;
      border-radius: 10px;
      font-size: 1.1rem;
      font-weight: 600;
      cursor: pointer;
      box-shadow: var(--sombra);
      transition: background 0.2s, box-shadow 0.2s, transform 0.1s;
      margin-bottom: 0.5rem;
    }
    input[type="text"]:focus, input[type="date"]:focus {
      border: 2px solid var(--azul-oscuro);
    }
    button {
      width: 100%;
      padding: 0.9rem 0;
      background: var(--azul-medio);
      color: var(--blanco);
      border: none;
      border-radius: 10px;
      font-size: 1.1rem;
      font-weight: 600;
      cursor: pointer;
      box-shadow: var(--sombra);
      transition: background 0.2s, box-shadow 0.2s, transform 0.1s;
      margin-bottom: 0.5rem;
    }
    button:hover {
      background: var(--azul-oscuro);
      box-shadow: 0 8px 32px rgba(24,90,219,0.22);
      transform: translateY(-2px) scale(1.03);
    }
    .greeting {
      font-size: 1.3rem;
      color: var(--azul-oscuro);
      margin-top: 1.5rem;
      text-align: center;
      font-weight: 500;
    }
    .task-section {
      width: 100%;
      margin-top: 1.2rem;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    .task-form {
      width: 100%;
      display: flex;
      flex-direction: column;
      gap: 0.7rem;
      margin-bottom: 1.2rem;
    }
    .task-list {
      width: 100%;
      list-style: none;
      padding: 0;
      margin: 0;
    }
    .task-item {
      background: var(--azul-claro);
      border-radius: 10px;
      box-shadow: 0 2px 8px rgba(24,90,219,0.08);
      margin-bottom: 0.7rem;
      padding: 0.8rem 1rem;
      display: flex;
      align-items: center;
      justify-content: space-between;
      transition: box-shadow 0.2s;
    }
    .task-item.completed {
      background: #e6f9e6;
      text-decoration: line-through;
      color: #6c8a6b;
    }
    .task-info {
      display: flex;
      flex-direction: column;
      gap: 0.2rem;
      flex: 1;
    }
    .task-title {
      font-size: 1rem;
      font-weight: 500;
    }
    .task-date {
      font-size: 0.9rem;
      color: #4a5a7a;
    }
    .task-actions {
      display: flex;
      gap: 0.5rem;
      margin-left: 0.7rem;
    }
    .task-actions button {
      width: auto;
      padding: 0.4rem 0.7rem;
      font-size: 0.95rem;
      border-radius: 7px;
      margin-bottom: 0;
      box-shadow: none;
    }
    .complete-btn {
      background: var(--verde);
      color: var(--blanco);
    }
    .complete-btn:hover {
      background: #2a8a00;
    }
    .delete-btn {
      background: var(--rojo);
      color: var(--blanco);
    }
    .delete-btn:hover {
      background: #b93222;
    }
    /* Extra: CSS para status-btn */
    .status-btn {
      transition: background 0.2s, color 0.2s, opacity 0.2s;
      outline: none;
    }
    .status-btn:focus {
      outline: 2px solid #185adb;
    }
    /* Extra: CSS para priority-select */
    .priority-select {
      margin-top: 0.2rem;
      border-radius: 7px;
      border: 1.5px solid #185adb;
      padding: 0.4rem 0.7rem;
      font-size: 0.95rem;
      color: #0a2342;
      background: #e5e9f2;
      font-weight: 600;
      outline: none;
      transition: border 0.2s;
    }
    .priority-select:focus {
      border: 2px solid #185adb;
    }
    @media (max-width: 500px) {
      .container {
        padding: 1.5rem 0.7rem 1.5rem 0.7rem;
        max-width: 98vw;
      }
      h1 {
        font-size: 1.5rem;
      }
      .task-title {
        font-size: 0.98rem;
      }
    }
  </style>
</head>
<body>
  <div class="container" id="mainContainer">
    <h1>My Homework</h1>
    <div id="registerSection">
      <div class="welcome">¡Bienvenido! Ingresa tu nombre para comenzar a organizar tus tareas.</div>
      <input type="text" id="userName" placeholder="Tu nombre..." autocomplete="off" />
      <button id="startBtn">Vamos a agregar tus tareas</button>
    </div>
    <div id="taskSection" style="display:none; width:100%;">
      <div class="greeting" id="greetingMsg"></div>
      <div class="task-section">
        <form class="task-form" id="taskForm">
          <input type="text" id="taskInput" placeholder="Nueva tarea..." required autocomplete="off" />
          <input type="date" id="taskDate" required />
          <button type="submit">Agregar tarea</button>
          <button type="button" id="calendarBtn">Calendario</button>
        </form>
        <ul class="task-list" id="taskList"></ul>
      </div>
    </div>
  </div>
  <!-- Modal calendario -->
  <div id="calendarModal" style="display:none;position:fixed;top:0;left:0;width:100vw;height:100vh;background:rgba(10,35,66,0.45);z-index:1000;align-items:center;justify-content:center;">
    <div style="background:#fff;color:#0a2342;border-radius:18px;max-width:95vw;width:400px;padding:2rem 1.2rem;box-shadow:0 8px 32px rgba(10,35,66,0.18);position:relative;">
      <button id="closeCalendar" style="position:absolute;top:0;right:0;width:44px;height:44px;background:none;border:none;font-size:2rem;color:#185adb;cursor:pointer;display:flex;align-items:center;justify-content:center;z-index:10;">&times;</button>
      <h2 style="margin-top:0;text-align:center;color:#185adb;">Calendario de Tareas</h2>
      <div id="calendarContent"></div>
    </div>
  </div>
  <script>
    // Registro y saludo
    const startBtn = document.getElementById('startBtn');
    const userNameInput = document.getElementById('userName');
    const registerSection = document.getElementById('registerSection');
    const taskSection = document.getElementById('taskSection');
    const greetingMsg = document.getElementById('greetingMsg');

    let userName = '';
    let tasks = [];

    startBtn.addEventListener('click', () => {
      const name = userNameInput.value.trim();
      if (name.length === 0) {
        userNameInput.focus();
        userNameInput.style.border = "2px solid #e74c3c";
        return;
      }
      userName = name;
      registerSection.style.display = "none";
      taskSection.style.display = "block";
      greetingMsg.textContent = `¡Hola, ${name}! Aquí puedes gestionar tus tareas.`;
      loadTasks();
      renderTasks();
    });

    userNameInput.addEventListener('input', () => {
      userNameInput.style.border = "1.5px solid var(--azul-medio)";
    });

    // Gestión de tareas
    const taskForm = document.getElementById('taskForm');
    const taskInput = document.getElementById('taskInput');
    const taskDate = document.getElementById('taskDate');
    const taskList = document.getElementById('taskList');

    // Establecer fecha actual como valor inicial en el input de fecha
    function setTodayAsDefaultDate() {
      const today = new Date();
      const yyyy = today.getFullYear();
      const mm = String(today.getMonth() + 1).padStart(2, '0');
      const dd = String(today.getDate()).padStart(2, '0');
      taskDate.value = `${yyyy}-${mm}-${dd}`;
    }
    setTodayAsDefaultDate();

    function saveTasks() {
      if (userName) {
        localStorage.setItem('tasks_' + userName, JSON.stringify(tasks));
      }
    }
    function loadTasks() {
      if (userName) {
        const saved = localStorage.getItem('tasks_' + userName);
        tasks = saved ? JSON.parse(saved) : [];
      }
    }
    function renderTasks() {
      taskList.innerHTML = '';
      if (tasks.length === 0) {
        taskList.innerHTML = '<li style="text-align:center;color:#888;">No tienes tareas aún.</li>';
        return;
      }
      tasks.forEach((task, idx) => {
        const li = document.createElement('li');
        li.className = 'task-item' + (task.status === 'Completada' ? ' completed' : '');
        const info = document.createElement('div');
        info.className = 'task-info';
        // Título editable
        const title = document.createElement('input');
        title.type = 'text';
        title.className = 'task-title';
        title.value = task.text;
        title.readOnly = !task.editing;
        title.style.background = task.editing ? '#fff' : 'transparent';
        title.style.border = task.editing ? '1px solid #185adb' : 'none';
        title.style.color = '#0a2342';
        title.style.fontWeight = '500';
        title.style.fontSize = '1rem';
        title.style.marginBottom = '0.2rem';
        // Fecha editable
        const date = document.createElement('input');
        date.type = 'date';
        date.className = 'task-date';
        date.value = task.date;
        date.readOnly = !task.editing;
        date.style.background = task.editing ? '#fff' : 'transparent';
        date.style.border = task.editing ? '1px solid #185adb' : 'none';
        date.style.color = '#4a5a7a';
        date.style.fontSize = '0.9rem';
        // Botón de estado
        const statusBtn = document.createElement('button');
        statusBtn.type = 'button';
        statusBtn.className = 'status-btn';
        statusBtn.textContent = (task.status === 'Completada') ? 'Completada' : 'En curso';
        statusBtn.style.background = (task.status === 'Completada') ? '#3ec300' : '#ffd600';
        statusBtn.style.color = (task.status === 'Completada') ? '#fff' : '#0a2342';
        statusBtn.style.fontWeight = 'bold';
        statusBtn.style.border = 'none';
        statusBtn.style.borderRadius = '7px';
        statusBtn.style.padding = '0.4rem 0.7rem';
        statusBtn.style.marginBottom = '0.2rem';
        statusBtn.style.cursor = 'pointer';
        statusBtn.style.boxShadow = '0 2px 8px rgba(24,90,219,0.08)';
        statusBtn.onmouseover = function() { statusBtn.style.opacity = '0.85'; };
        statusBtn.onmouseout = function() { statusBtn.style.opacity = '1'; };
        statusBtn.onclick = () => {
          tasks[idx].status = (task.status === 'En curso') ? 'Completada' : 'En curso';
          saveTasks();
          renderTasks();
        };
        // Prioridad
        const priority = document.createElement('select');
        priority.className = 'priority-select';
        const priorityColors = {
          'Baja': {bg: '#b9fbc0', color: '#0a2342'}, // verde pastel
          'Media': {bg: '#ffe5b4', color: '#0a2342'}, // naranja pastel
          'Alta': {bg: '#ffb3b3', color: '#0a2342'}, // rojo pastel
          'Urgente': {bg: '#222', color: '#fff'} // negro con blanco
        };
        ['Baja', 'Media', 'Alta', 'Urgente'].forEach(opt => {
          const option = document.createElement('option');
          option.value = opt;
          option.textContent = 'Prioridad: ' + opt;
          if ((task.priority || 'Media') === opt) option.selected = true;
          option.style.background = priorityColors[opt].bg;
          option.style.color = priorityColors[opt].color;
          priority.appendChild(option);
        });
        // Aplica color al select según valor
        function setPriorityColor() {
          const val = priority.value;
          priority.style.background = priorityColors[val].bg;
          priority.style.color = priorityColors[val].color;
        }
        setPriorityColor();
        priority.disabled = !task.editing;
        priority.addEventListener('change', () => {
          tasks[idx].priority = priority.value;
          saveTasks();
          setPriorityColor();
        });
        // Guardar cambios al salir de edición
        title.addEventListener('change', () => {
          tasks[idx].text = title.value;
          saveTasks();
        });
        date.addEventListener('change', () => {
          tasks[idx].date = date.value;
          saveTasks();
        });
        info.appendChild(title);
        info.appendChild(date);
        info.appendChild(statusBtn);
        info.appendChild(priority);
        li.appendChild(info);
        const actions = document.createElement('div');
        actions.className = 'task-actions';
        // Botón editar/guardar
        const editBtn = document.createElement('button');
        editBtn.className = 'edit-btn';
        editBtn.textContent = task.editing ? 'Guardar' : 'Editar';
        editBtn.onclick = () => {
          if (task.editing) {
            tasks[idx].editing = false;
            tasks[idx].text = title.value;
            tasks[idx].date = date.value;
            tasks[idx].priority = priority.value;
            saveTasks();
          } else {
            tasks.forEach(t => t.editing = false);
            tasks[idx].editing = true;
          }
          renderTasks();
        };
        // Botón eliminar
        const deleteBtn = document.createElement('button');
        deleteBtn.className = 'delete-btn';
        deleteBtn.textContent = 'Eliminar';
        deleteBtn.onclick = () => {
          tasks.splice(idx, 1);
          saveTasks();
          renderTasks();
        };
        actions.appendChild(editBtn);
        actions.appendChild(deleteBtn);
        li.appendChild(actions);
        taskList.appendChild(li);
      });
    }
    taskForm.addEventListener('submit', e => {
      e.preventDefault();
      const text = taskInput.value.trim();
      const date = taskDate.value;
      if (!text || !date) return;
      tasks.push({ text, date, status: 'En curso', editing: false, priority: 'Media' });
      saveTasks();
      renderTasks();
      taskInput.value = '';
      setTodayAsDefaultDate();
      taskInput.focus();
    });
    // Calendario
    const calendarBtn = document.getElementById('calendarBtn');
    const calendarModal = document.getElementById('calendarModal');
    const closeCalendar = document.getElementById('closeCalendar');
    const calendarContent = document.getElementById('calendarContent');

    calendarBtn.addEventListener('click', () => {
      renderCalendar();
      calendarModal.style.display = 'flex';
    });
    closeCalendar.addEventListener('click', () => {
      calendarModal.style.display = 'none';
    });
    window.addEventListener('click', (e) => {
      if (e.target === calendarModal) calendarModal.style.display = 'none';
    });

    function renderCalendar() {
      if (!tasks.length) {
        calendarContent.innerHTML = '<div style="text-align:center;color:#888;">No tienes tareas aún.</div>';
        return;
      }
      calendarContent.innerHTML = tasks.map(task => `
        <div style="background:${task.status==='Completada'?'#e6f9e6':'#f3f8ff'};border-radius:10px;padding:0.8rem 1rem;margin-bottom:1rem;box-shadow:0 2px 8px rgba(24,90,219,0.08);">
          <div style="font-weight:600;font-size:1.08rem;">${task.text}</div>
          <div style="font-size:0.97rem;color:#4a5a7a;">Fecha: ${task.date}</div>
          <div style="font-size:0.97rem;">Estado: <span style="font-weight:600;color:${task.status==='Completada'?'#3ec300':'#ffd600'}">${task.status}</span></div>
          <div style="font-size:0.97rem;">Prioridad: <span style="font-weight:600;${task.priority==='Baja'?'color:#0a2342;background:#b9fbc0;padding:2px 8px;border-radius:6px;':task.priority==='Media'?'color:#0a2342;background:#ffe5b4;padding:2px 8px;border-radius:6px;':task.priority==='Alta'?'color:#0a2342;background:#ffb3b3;padding:2px 8px;border-radius:6px;':'color:#fff;background:#222;padding:2px 8px;border-radius:6px;'}">${task.priority||'Media'}</span></div>
        </div>
      `).join('');
    }
  </script>
</body>
</html>
